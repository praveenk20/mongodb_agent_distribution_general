<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration - MongoDB Agent AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f7fa;
        }

        .nav {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
        }

        .nav a:hover {
            text-decoration: underline;
        }

        .container {
            max-width: 900px;
            margin: 40px auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2.5em;
        }

        h2 {
            color: #667eea;
            margin-top: 30px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        h3 {
            color: #555;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        p {
            margin-bottom: 15px;
        }

        pre {
            background: #2d3748;
            color: #f7fafc;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
        }

        code {
            font-family: 'Courier New', monospace;
        }

        .info-box {
            background: #e8f4f8;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #fff4e6;
            border-left: 4px solid #fb923c;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success-box {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        ul, ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #667eea;
        }

        .next-steps {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .next-steps a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .next-steps a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="nav">
        <div><a href="index.html">‚Üê Back to Documentation Hub</a></div>
        <div>MongoDB Agent AI - Configuration</div>
    </div>

    <div class="container">
        <h1>‚öôÔ∏è Configuration</h1>
        <p>Configure MongoDB Agent AI using environment variables in a <code>.env</code> file.</p>

        <h2 id="direct-connection">üîå Direct Connection Setup</h2>
        <p><strong>Recommended for:</strong> Quick setup, standalone applications, low latency</p>
        <p><strong>Setup time:</strong> 5 minutes</p>

        <h3>Step 1: Create .env File</h3>
        <pre><code># In mongodb_agent_distribution_general directory
nano .env</code></pre>

        <h3>Step 2: Configure Direct Connection</h3>
        <pre><code># ============================================
# MONGODB CONFIGURATION (Direct Connection)
# ============================================
MONGODB_CONNECTION_TYPE=direct

# MongoDB Connection String
MONGODB_URI=mongodb+srv://username:password@host.mongodb.net/?authMechanism=DEFAULT&authSource=admin

# Database Name
MONGODB_DATABASE=your_database_name

# Optional: Connection Pool Settings
MONGODB_MAX_POOL_SIZE=50
MONGODB_MIN_POOL_SIZE=10

# ============================================
# LLM PROVIDER CONFIGURATION
# ============================================

# Choose ONE provider (uncomment relevant section)

# --- OpenAI ---
LLM_PROVIDER=openai
OPENAI_API_KEY=sk-...your-key...

# --- Anthropic ---
# LLM_PROVIDER=anthropic
# ANTHROPIC_API_KEY=sk-ant-...your-key...

# --- Azure OpenAI ---
# LLM_PROVIDER=azure_openai
# AZURE_OPENAI_API_KEY=...your-key...
# AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
# AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4
# AZURE_OPENAI_API_VERSION=2024-02-15-preview

# ============================================
# SERVER CONFIGURATION
# ============================================
SERVER_PORT=8000
LOG_LEVEL=INFO</code></pre>

        <h3>MongoDB Connection String Examples</h3>
        
        <p><strong>MongoDB Atlas (Cloud):</strong></p>
        <pre><code>MONGODB_URI=mongodb+srv://user:pass@cluster.mongodb.net/?authMechanism=DEFAULT&authSource=admin</code></pre>

        <p><strong>Self-Hosted MongoDB:</strong></p>
        <pre><code>MONGODB_URI=mongodb://user:pass@localhost:27017/?authMechanism=DEFAULT&authSource=admin</code></pre>

        <p><strong>Replica Set:</strong></p>
        <pre><code>MONGODB_URI=mongodb://user:pass@host1:27017,host2:27017,host3:27017/?replicaSet=rs0&authSource=admin</code></pre>

        <div class="info-box">
            <strong>üîí Security Tip:</strong> Never commit <code>.env</code> files to version control. Add to <code>.gitignore</code>
        </div>

        <h3>Step 3: Test Connection</h3>
        <pre><code># Start the server
python3 -m mongodb_agent.api

# Expected output:
INFO:     MongoDB Agent starting...
INFO:     Connection type: direct
INFO:     Connected to MongoDB: your_database_name
INFO:     Server running on http://0.0.0.0:8000</code></pre>

        <h2 id="mcp-connection">üåê MCP Protocol Setup</h2>
        <p><strong>Recommended for:</strong> Claude Desktop, enterprise OAuth, centralized auth</p>
        <p><strong>Setup time:</strong> 30+ minutes</p>

        <div class="warning-box">
            <strong>‚ö†Ô∏è Prerequisites:</strong> MCP server must be running and accessible before starting the agent
        </div>

        <h3>Step 1: Create .env File</h3>
        <pre><code># In mongodb_agent_distribution_general directory
nano .env</code></pre>

        <h3>Step 2: Configure MCP Connection</h3>
        <pre><code># ============================================
# MONGODB CONFIGURATION (MCP Protocol)
# ============================================
MONGODB_CONNECTION_TYPE=mcp

# MCP Server Endpoint
MONGODB_MCP_ENDPOINT=http://localhost:3000/mongodb/query

# OAuth Token URL (for authentication)
MONGODB_OAUTH_TOKEN_URL=https://your-oauth-server.com/oauth/token

# OAuth Credentials
MONGODB_OAUTH_CLIENT_ID=your-client-id
MONGODB_OAUTH_CLIENT_SECRET=your-client-secret

# Token Cache (optional - reduces auth calls)
MONGODB_TOKEN_CACHE_TTL=3600  # 1 hour

# ============================================
# LLM PROVIDER CONFIGURATION
# ============================================

# Choose ONE provider (same as Direct Connection)
LLM_PROVIDER=openai
OPENAI_API_KEY=sk-...your-key...

# ============================================
# SERVER CONFIGURATION
# ============================================
SERVER_PORT=8000
LOG_LEVEL=INFO</code></pre>

        <div class="info-box">
            <strong>üì° MCP Server:</strong> Must be deployed separately. Contact your infrastructure team for endpoint details.
        </div>

        <h3>Step 3: Test MCP Connection</h3>
        <pre><code># Start the server
python3 -m mongodb_agent.api

# Expected output:
INFO:     MongoDB Agent starting...
INFO:     Connection type: mcp
INFO:     MCP endpoint: http://localhost:3000/mongodb/query
INFO:     OAuth token acquired
INFO:     Server running on http://0.0.0.0:8000</code></pre>

        <h2 id="llm-providers">ü§ñ LLM Provider Configuration</h2>

        <h3>OpenAI</h3>
        <pre><code>LLM_PROVIDER=openai
OPENAI_API_KEY=sk-...your-key...
OPENAI_MODEL=gpt-4  # Optional, default: gpt-4</code></pre>

        <h3>Anthropic (Claude)</h3>
        <pre><code>LLM_PROVIDER=anthropic
ANTHROPIC_API_KEY=sk-ant-...your-key...
ANTHROPIC_MODEL=claude-3-opus-20240229  # Optional</code></pre>

        <h3>Azure OpenAI</h3>
        <pre><code>LLM_PROVIDER=azure_openai
AZURE_OPENAI_API_KEY=...your-key...
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4
AZURE_OPENAI_API_VERSION=2024-02-15-preview</code></pre>

        <h2>üìã Complete Configuration Reference</h2>

        <table>
            <thead>
                <tr>
                    <th>Variable</th>
                    <th>Required</th>
                    <th>Default</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>MONGODB_CONNECTION_TYPE</code></td>
                    <td>Yes</td>
                    <td>direct</td>
                    <td>Connection type: <code>direct</code> or <code>mcp</code></td>
                </tr>
                <tr>
                    <td><code>MONGODB_URI</code></td>
                    <td>Yes (Direct)</td>
                    <td>-</td>
                    <td>MongoDB connection string</td>
                </tr>
                <tr>
                    <td><code>MONGODB_DATABASE</code></td>
                    <td>Yes (Direct)</td>
                    <td>-</td>
                    <td>Database name</td>
                </tr>
                <tr>
                    <td><code>MONGODB_MCP_ENDPOINT</code></td>
                    <td>Yes (MCP)</td>
                    <td>-</td>
                    <td>MCP server URL</td>
                </tr>
                <tr>
                    <td><code>MONGODB_OAUTH_TOKEN_URL</code></td>
                    <td>Yes (MCP)</td>
                    <td>-</td>
                    <td>OAuth token endpoint</td>
                </tr>
                <tr>
                    <td><code>LLM_PROVIDER</code></td>
                    <td>Yes</td>
                    <td>openai</td>
                    <td>LLM provider: openai, anthropic, azure_openai</td>
                </tr>
                <tr>
                    <td><code>OPENAI_API_KEY</code></td>
                    <td>Yes (OpenAI)</td>
                    <td>-</td>
                    <td>OpenAI API key</td>
                </tr>
                <tr>
                    <td><code>SERVER_PORT</code></td>
                    <td>No</td>
                    <td>8000</td>
                    <td>FastAPI server port</td>
                </tr>
                <tr>
                    <td><code>LOG_LEVEL</code></td>
                    <td>No</td>
                    <td>INFO</td>
                    <td>Logging level: DEBUG, INFO, WARNING, ERROR</td>
                </tr>
            </tbody>
        </table>

        <h2>üîÑ Switching Between Connection Types</h2>
        <p>You can switch between Direct and MCP by changing one line in <code>.env</code>:</p>

        <pre><code># Switch to Direct Connection
MONGODB_CONNECTION_TYPE=direct

# Switch to MCP Protocol
MONGODB_CONNECTION_TYPE=mcp</code></pre>

        <div class="info-box">
            <strong>üí° Tip:</strong> Keep both configurations in your <code>.env</code> file and comment out the unused one
        </div>

        <h2>üß™ Verify Configuration</h2>
        
        <h3>Test 1: Load Environment</h3>
        <pre><code>python3 -c "from dotenv import load_dotenv; import os; load_dotenv(); print('‚úÖ Connection type:', os.getenv('MONGODB_CONNECTION_TYPE'))"</code></pre>

        <h3>Test 2: Connection Test</h3>
        <pre><code># Start server and check logs
python3 -m mongodb_agent.api

# Look for:
# ‚úÖ "Connected to MongoDB" (Direct)
# ‚úÖ "OAuth token acquired" (MCP)</code></pre>

        <h3>Test 3: API Health Check</h3>
        <pre><code>curl http://localhost:8000/health

# Expected response:
{"status": "healthy", "connection": "direct|mcp"}</code></pre>

        <div class="next-steps">
            <h3>üìö Next Steps</h3>
            <p>Configuration complete! Now start using the agent:</p>
            <ul>
                <li><a href="usage.html">üí° Usage Examples</a> - Try your first queries</li>
                <li><a href="api-reference.html">üìñ API Reference</a> - Explore all endpoints</li>
                <li><a href="troubleshooting.html">üîß Troubleshooting</a> - Fix common issues</li>
            </ul>
        </div>
    </div>
</body>
</html>
